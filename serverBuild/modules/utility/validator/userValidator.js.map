{"version":3,"sources":["../../../../server/modules/utility/validator/userValidator.js"],"names":["jwt","require","UserValidator","validateUser","req","res","next","console","log","token","body","headers","appData","verify","process","env","SECRET_KEY","err","status","json","validateToken"],"mappings":";;;;;;;;AACA,IAAIA,MAAMC,QAAQ,cAAR,CAAV;;IAEMC,a;;;SACFC,Y,GAAe,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAkB;AAC7BC,gBAAQC,GAAR,CAAY,eAAZ;AACA,YAAIC,QAAQL,IAAIM,IAAJ,CAASD,KAAT,IAAkBL,IAAIO,OAAJ,CAAY,OAAZ,CAA9B;AACA,YAAIC,UAAU,EAAd;AACA,YAAIH,KAAJ,EAAW;AACPT,gBAAIa,MAAJ,CAAWJ,KAAX,EAAkBK,QAAQC,GAAR,CAAYC,UAA9B,EAA0C,UAASC,GAAT,EAAc;AACpD,oBAAIA,GAAJ,EAAS;AACLL,4BAAQ,OAAR,IAAmB,CAAnB;AACAA,4BAAQ,MAAR,IAAkB,kBAAlB;AACAP,wBAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBP,OAArB;AACH,iBAJD,MAIO;AACHN;AACH;AACJ,aARD;AASH,SAVD,MAUO;AACHM,oBAAQ,OAAR,IAAmB,CAAnB;AACAA,oBAAQ,MAAR,IAAkB,qBAAlB;AACAP,gBAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBP,OAArB;AACH;AACJ,K;;SACDQ,a,GAAgB,UAAChB,GAAD,EAAMC,GAAN,EAAY;AACxBE,gBAAQC,GAAR,CAAY,gBAAZ;AACA,YAAIC,QAAQL,IAAIM,IAAJ,CAASD,KAAT,IAAkBL,IAAIO,OAAJ,CAAY,OAAZ,CAA9B;AACA,YAAIC,UAAU,EAAd;AACA,YAAIH,KAAJ,EAAW;AACPT,gBAAIa,MAAJ,CAAWJ,KAAX,EAAkBK,QAAQC,GAAR,CAAYC,UAA9B,EAA0C,UAASC,GAAT,EAAc;AACpD,oBAAIA,GAAJ,EAAS;AACLL,4BAAQ,OAAR,IAAmB,CAAnB;AACAA,4BAAQ,MAAR,IAAkB,kBAAlB;AACAP,wBAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBP,OAArB;AACH,iBAJD,MAIO;AACHA,4BAAQ,OAAR,IAAmB,CAAnB;AACAA,4BAAQ,MAAR,IAAgB,gBAAhB;AACAP,wBAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBP,OAArB;AACH;AACJ,aAVD;AAWH,SAZD,MAYO;AACHA,oBAAQ,OAAR,IAAmB,CAAnB;AACAA,oBAAQ,MAAR,IAAkB,qBAAlB;AACAP,gBAAIa,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBP,OAArB;AACH;AACJ,K;;;kBAGUV,a","file":"userValidator.js","sourcesContent":["\r\nvar jwt = require('jsonwebtoken');\r\n\r\nclass UserValidator {\r\n    validateUser = (req, res, next)=>{\r\n        console.log('validate user');\r\n        var token = req.body.token || req.headers['token'];\r\n        var appData = {};\r\n        if (token) {\r\n            jwt.verify(token, process.env.SECRET_KEY, function(err) {\r\n                if (err) {\r\n                    appData['error'] = 1;\r\n                    appData['data'] = 'Token is invalid';\r\n                    res.status(500).json(appData);\r\n                } else {\r\n                    next();\r\n                }\r\n            });\r\n        } else {\r\n            appData['error'] = 1;\r\n            appData['data'] = 'Please send a token';\r\n            res.status(403).json(appData);\r\n        }\r\n    } \r\n    validateToken = (req, res)=>{\r\n        console.log('validate Token');\r\n        var token = req.body.token || req.headers['token'];\r\n        var appData = {};\r\n        if (token) {\r\n            jwt.verify(token, process.env.SECRET_KEY, function(err) {\r\n                if (err) {\r\n                    appData['error'] = 1;\r\n                    appData['data'] = 'Token is invalid';\r\n                    res.status(500).json(appData);\r\n                } else {\r\n                    appData['error'] = 0;\r\n                    appData['data']='Token is valid';\r\n                    res.status(200).json(appData);\r\n                }\r\n            });\r\n        } else {\r\n            appData['error'] = 1;\r\n            appData['data'] = 'Please send a token';\r\n            res.status(403).json(appData);\r\n        }\r\n    }\r\n}\r\n\r\nexport default UserValidator;"]}